# 33. 행에 있는 값을 열로 올리는 방법
열에 있는 값을 행으로 내렸을 때 문제가 생길 수 있음

---

### pivot_table

```python
df.pivot_table(index="고정하고 싶은 열(세로)", columns="열(가로)로 올리고 싶은 열(세로)", 
	values="새로 올라간 열이 가지는 값", dprona=True/False)
```

```python
# 날씨데이터(최고기온과 최저기온)

import pandas as pd

weather = pd.read_csv("weather.csv")
weather
```

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/cbc75ed9-6bd0-4fe6-aa06-705c14637c66/Untitled.png)

날짜열들이 보기 지저분해 보인다 → 행으로 내려줌

```python
# d1~ 을 행으로 내려준다.

 weather2 = pd.melt(weather, id_vars=["id",'year','month','element'] ,
	var_name="day", value_name="temp")
 weather2
```

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/da0d3d74-25f0-4e75-bcc5-a76ee4a3cf92/Untitled.png)

element열의 값을 열로 만들어주면 더 깔끔할듯

```python
# element의 열의 값을 열로 올린다.

weather3 = weather2.pivot_table(index=['id','year','month','day'], 
                                columns='element', values='temp', dropna=False)
weather3
```

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/31a64b87-d872-40ba-ab0f-db48eb25afec/Untitled.png)

결측치가 많아보인다 → 날려주자!

```python
# drpona=True는 nan 값이 하나라도 있으면 날려버림

weather3 = weather2.pivot_table(index=['id','year','month','day'], 
                                columns='element', values='temp', dropna=True)
weather3
```

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/3d499e3b-e6f5-4087-ae30-00f46b1b500c/Untitled.png)

---

### 인덱스 새롭게 다시 만들기

```python
df.reset_index()
```

컬럼명을 정리해주자

```python
# 인덱스 정리
weather4 = weather3.reset_index()
weather4
# element는 그냥 빠져나간 것
```

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/7916b0a7-d848-4c3e-97bb-45257ed83e1e/Untitled.png)

---

[Google Colaboratory](https://colab.research.google.com/drive/16iMKzDebAXR45a1sqSgQPupTEAZGe5l1?usp=sharing)<br>
[Notion](https://determined-fan-807.notion.site/33-f80af556133c497c8f4b0765c29b7ad7)
